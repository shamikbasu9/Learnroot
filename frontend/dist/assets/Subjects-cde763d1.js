import{a as B,q as D,r as n,j as q,o,k as z,l as H,b as e,c as l,d as C,e as j,s as P,h as i,f as u,i as b,m as O,F,t as c,w as G,v as S,x as M}from"./index-057104a9.js";import{_ as L,a as v}from"./DashboardLayout-068cd469.js";import{P as Y}from"./plus-3b2803ef.js";import{B as R}from"./book-open-214ef39a.js";const I={class:"space-y-6"},J={class:"flex justify-between items-center"},K={class:"card p-4"},Q={class:"flex flex-wrap gap-4"},W={key:0,class:"mb-4 p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg"},X={class:"card"},Z={class:"overflow-x-auto"},ee={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},te={class:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700"},ae={key:0},re={key:1},se={colspan:"6",class:"px-6 py-8 text-center"},oe={class:"text-gray-500 dark:text-gray-400"},le={class:"px-6 py-4 whitespace-nowrap"},de={class:"text-sm font-medium text-gray-900 dark:text-white"},ne={class:"px-6 py-4 whitespace-nowrap"},ie={class:"text-sm text-gray-900 dark:text-white"},ue={class:"px-6 py-4 whitespace-nowrap"},ce={class:"px-6 py-4 whitespace-nowrap"},pe={class:"px-6 py-4"},ye={class:"text-sm text-gray-900 dark:text-white"},ge={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},xe=["onClick"],me=["onClick"],be={key:1,class:"fixed inset-0 z-50 overflow-y-auto"},ve={class:"flex items-center justify-center min-h-screen px-4"},ke={class:"relative bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6"},fe={class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},we={class:"space-y-4"},he={class:"mt-6 flex justify-end space-x-3"},Se=["disabled"],Ve={__name:"Subjects",setup(_e){const _=B(),y=D(()=>{var r,t;return((r=_.user)==null?void 0:r.role)==="school_admin"||((t=_.user)==null?void 0:t.role)==="super_admin"}),k=n([]),f=n(!0),x=n(!1),m=n(!1),p=n(!1),w=n(null),d=n({stream:"",type:""}),s=n({name:"",code:"",type:"",stream:"",description:""}),A=r=>({core:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",elective:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",optional:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"})[r]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",V=r=>({science:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",commerce:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",humanities:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200",general:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"})[r]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",g=async()=>{try{f.value=!0;const r=new URLSearchParams;d.value.stream&&r.append("stream",d.value.stream),d.value.type&&r.append("type",d.value.type);const t=await v.get(`/subjects?${r.toString()}`);k.value=t.data.data||[]}catch(r){console.error("Error fetching subjects:",r)}finally{f.value=!1}},E=()=>{s.value={name:"",code:"",type:"",stream:"",description:""}},h=()=>{m.value=!1,p.value=!1,w.value=null,E()},U=r=>{w.value=r,s.value={name:r.name,code:r.code,type:r.type,stream:r.stream,description:r.description||""},p.value=!0},$=async()=>{x.value=!0;try{p.value?await v.put(`/subjects/${w.value.id}`,s.value):await v.post("/subjects",s.value),await g(),h()}catch(r){console.error("Error saving subject:",r)}finally{x.value=!1}},N=async r=>{if(confirm(`Are you sure you want to delete "${r.name}"?`))try{await v.delete(`/subjects/${r.id}`),await g()}catch(t){console.error("Error deleting subject:",t)}};return q(()=>{g()}),(r,t)=>(o(),z(L,null,{default:H(()=>[e("div",I,[e("div",J,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Subjects Management "),e("p",{class:"text-gray-600 dark:text-gray-400"}," Manage subjects and their properties ")],-1)),y.value?(o(),l("button",{key:0,onClick:t[0]||(t[0]=a=>m.value=!0),class:"btn btn-primary"},[C(j(Y),{class:"h-5 w-5 mr-2"}),t[9]||(t[9]=P(" Add Subject ",-1))])):i("",!0)]),e("div",K,[e("div",Q,[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Stream ",-1)),u(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>d.value.stream=a),onChange:g,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"},[...t[11]||(t[11]=[e("option",{value:""},"All Streams",-1),e("option",{value:"science"},"Science",-1),e("option",{value:"commerce"},"Commerce",-1),e("option",{value:"humanities"},"Humanities",-1),e("option",{value:"general"},"General",-1)])],544),[[b,d.value.stream]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Type ",-1)),u(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>d.value.type=a),onChange:g,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"},[...t[13]||(t[13]=[e("option",{value:""},"All Types",-1),e("option",{value:"core"},"Core",-1),e("option",{value:"elective"},"Elective",-1),e("option",{value:"optional"},"Optional",-1)])],544),[[b,d.value.type]])])])]),y.value?i("",!0):(o(),l("div",W,[...t[15]||(t[15]=[e("div",{class:"flex"},[e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])]),e("div",{class:"ml-3"},[e("p",{class:"text-sm text-yellow-800 dark:text-yellow-200"}," You have view-only access. Only school administrators can add, edit, or delete subjects. ")])],-1)])])),e("div",X,[e("div",Z,[e("table",ee,[t[18]||(t[18]=e("thead",{class:"bg-gray-50 dark:bg-gray-800"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Subject Name "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Code "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Type "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Stream "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Description "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",te,[f.value?(o(),l("tr",ae,[...t[16]||(t[16]=[e("td",{colspan:"6",class:"px-6 py-4 text-center"},[e("div",{class:"spinner"})],-1)])])):k.value.length===0?(o(),l("tr",re,[e("td",se,[e("div",oe,[C(j(R),{class:"h-12 w-12 mx-auto mb-4 opacity-50"}),t[17]||(t[17]=e("p",null,"No subjects found",-1)),y.value?(o(),l("button",{key:0,onClick:t[3]||(t[3]=a=>m.value=!0),class:"mt-2 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300"}," Add your first subject ")):i("",!0)])])])):i("",!0),(o(!0),l(F,null,O(k.value,a=>(o(),l("tr",{key:a.id},[e("td",le,[e("div",de,c(a.name),1)]),e("td",ne,[e("div",ie,c(a.code),1)]),e("td",ue,[e("span",{class:M(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",A(a.type)])},c(a.type),3)]),e("td",ce,[e("span",{class:M(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",V(a.stream)])},c(a.stream),3)]),e("td",pe,[e("div",ye,c(a.description||"-"),1)]),e("td",ge,[y.value?(o(),l("button",{key:0,onClick:T=>U(a),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-3"}," Edit ",8,xe)):i("",!0),y.value?(o(),l("button",{key:1,onClick:T=>N(a),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"}," Delete ",8,me)):i("",!0)])]))),128))])])])]),m.value||p.value?(o(),l("div",be,[e("div",ve,[e("div",{class:"fixed inset-0 bg-black opacity-50",onClick:h}),e("div",ke,[e("h3",fe,c(p.value?"Edit Subject":"Add New Subject"),1),e("form",{onSubmit:G($,["prevent"])},[e("div",we,[e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Subject Name ",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=a=>s.value.name=a),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400",placeholder:"e.g., Mathematics, Physics"},null,512),[[S,s.value.name]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Subject Code ",-1)),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=a=>s.value.code=a),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400",placeholder:"e.g., MATH, PHY"},null,512),[[S,s.value.code]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Type ",-1)),u(e("select",{"onUpdate:modelValue":t[6]||(t[6]=a=>s.value.type=a),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"},[...t[21]||(t[21]=[e("option",{value:""},"Select type",-1),e("option",{value:"core"},"Core",-1),e("option",{value:"elective"},"Elective",-1),e("option",{value:"optional"},"Optional",-1)])],512),[[b,s.value.type]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Stream ",-1)),u(e("select",{"onUpdate:modelValue":t[7]||(t[7]=a=>s.value.stream=a),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"},[...t[23]||(t[23]=[e("option",{value:""},"Select stream",-1),e("option",{value:"science"},"Science",-1),e("option",{value:"commerce"},"Commerce",-1),e("option",{value:"humanities"},"Humanities",-1),e("option",{value:"general"},"General",-1)])],512),[[b,s.value.stream]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Description (optional) ",-1)),u(e("textarea",{"onUpdate:modelValue":t[8]||(t[8]=a=>s.value.description=a),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400",placeholder:"Subject description..."},null,512),[[S,s.value.description]])])]),e("div",he,[e("button",{type:"button",onClick:h,class:"btn btn-secondary"}," Cancel "),e("button",{type:"submit",disabled:x.value,class:"btn btn-primary"},c(x.value?"Saving...":p.value?"Update":"Add"),9,Se)])],32)])])])):i("",!0)])]),_:1}))}};export{Ve as default};
