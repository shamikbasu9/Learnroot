import{a as U,q as C,r as d,j as P,o as r,k as q,l as F,b as e,c as l,d as G,e as M,s as T,h as n,m as h,F as w,t as i,w as H,f as g,v as A,i as L,x as O,g as Y}from"./index-057104a9.js";import{_ as I,a as y,G as J}from"./DashboardLayout-068cd469.js";import{P as K}from"./plus-3b2803ef.js";import"./book-open-214ef39a.js";const Q={class:"space-y-6"},R={class:"flex justify-between items-center"},W={key:0,class:"mb-4 p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg"},X={class:"card"},Z={class:"overflow-x-auto"},ee={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},te={class:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700"},se={key:0},ae={key:1},re={colspan:"5",class:"px-6 py-8 text-center"},le={class:"text-gray-500 dark:text-gray-400"},oe={class:"px-6 py-4 whitespace-nowrap"},de={class:"text-sm font-medium text-gray-900 dark:text-white"},ne={class:"px-6 py-4 whitespace-nowrap"},ie={class:"px-6 py-4"},ue={class:"text-sm text-gray-900 dark:text-white"},ce={class:"inline-flex px-2 py-1 text-xs font-medium rounded bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},xe={key:0,class:"text-gray-400"},ye={class:"px-6 py-4"},pe={class:"text-sm text-gray-900 dark:text-white"},me={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},ge=["onClick"],be=["onClick"],ve={key:1,class:"fixed inset-0 z-50 overflow-y-auto"},ke={class:"flex items-center justify-center min-h-screen px-4"},fe={class:"relative bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6"},he={class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},we={class:"space-y-4"},_e={class:"space-y-2 max-h-40 overflow-y-auto border border-gray-300 dark:border-gray-600 rounded-md p-2"},Se=["id","value"],je=["for"],Ce={class:"mt-6 flex justify-end space-x-3"},Ge=["disabled"],De={__name:"Grades",setup(Me){const _=U(),x=C(()=>{var a,t;return((a=_.user)==null?void 0:a.role)==="school_admin"||((t=_.user)==null?void 0:t.role)==="super_admin"}),b=d([]),S=d([]),j=d(!0),p=d(!1),m=d(!1),u=d(!1),v=d(null),o=d({name:"",segment:"",subjects:[],description:""}),N=C(()=>S.value),V=a=>({primary:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",secondary:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",sr_secondary:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"})[a]||"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200",k=async()=>{try{const a=await y.get("/grades");b.value=a.data.data||[]}catch(a){console.error("Error fetching grades:",a)}finally{j.value=!1}},E=async()=>{try{const a=await y.get("/subjects");S.value=a.data.data||[]}catch(a){console.error("Error fetching subjects:",a)}},$=()=>{o.value={name:"",segment:"",subjects:[],description:""}},f=()=>{m.value=!1,u.value=!1,v.value=null,$()},D=a=>{v.value=a,o.value={name:a.name,segment:a.segment,subjects:a.subjects||[],description:a.description||""},u.value=!0},z=async()=>{p.value=!0;try{u.value?await y.put(`/grades/${v.value.id}`,o.value):await y.post("/grades",o.value),await k(),f()}catch(a){console.error("Error saving grade:",a)}finally{p.value=!1}},B=async a=>{if(confirm(`Are you sure you want to delete "${a.name}"?`))try{await y.delete(`/grades/${a.id}`),await k()}catch(t){console.error("Error deleting grade:",t)}};return P(async()=>{await Promise.all([k(),E()])}),(a,t)=>(r(),q(I,null,{default:F(()=>[e("div",Q,[e("div",R,[t[7]||(t[7]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Grades Management "),e("p",{class:"text-gray-600 dark:text-gray-400"}," Manage grade levels and subjects ")],-1)),x.value?(r(),l("button",{key:0,onClick:t[0]||(t[0]=s=>m.value=!0),class:"btn btn-primary"},[G(M(K),{class:"h-5 w-5 mr-2"}),t[6]||(t[6]=T(" Add Grade ",-1))])):n("",!0)]),x.value?n("",!0):(r(),l("div",W,[...t[8]||(t[8]=[e("div",{class:"flex"},[e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])]),e("div",{class:"ml-3"},[e("p",{class:"text-sm text-yellow-800 dark:text-yellow-200"}," You have view-only access. Only school administrators can add, edit, or delete grades. ")])],-1)])])),e("div",X,[e("div",Z,[e("table",ee,[t[11]||(t[11]=e("thead",{class:"bg-gray-50 dark:bg-gray-800"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Grade Name "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Segment "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Subjects "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Description "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",te,[j.value?(r(),l("tr",se,[...t[9]||(t[9]=[e("td",{colspan:"5",class:"px-6 py-4 text-center"},[e("div",{class:"spinner"})],-1)])])):b.value.length===0?(r(),l("tr",ae,[e("td",re,[e("div",le,[G(M(J),{class:"h-12 w-12 mx-auto mb-4 opacity-50"}),t[10]||(t[10]=e("p",null,"No grades found",-1)),x.value?(r(),l("button",{key:0,onClick:t[1]||(t[1]=s=>m.value=!0),class:"mt-2 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300"}," Add your first grade ")):n("",!0)])])])):n("",!0),(r(!0),l(w,null,h(b.value,s=>(r(),l("tr",{key:s.id},[e("td",oe,[e("div",de,i(s.name),1)]),e("td",ne,[e("span",{class:O(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",V(s.segment)])},i(s.segment),3)]),e("td",ie,[e("div",ue,[(r(!0),l(w,null,h(s.subjects_details,(c,Ae)=>(r(),l("span",{key:c.id,class:"inline-block mr-2 mb-1"},[e("span",ce,i(c.name),1)]))),128)),!s.subjects_details||s.subjects_details.length===0?(r(),l("span",xe," No subjects ")):n("",!0)])]),e("td",ye,[e("div",pe,i(s.description||"-"),1)]),e("td",me,[x.value?(r(),l("button",{key:0,onClick:c=>D(s),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-3"}," Edit ",8,ge)):n("",!0),x.value?(r(),l("button",{key:1,onClick:c=>B(s),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"}," Delete ",8,be)):n("",!0)])]))),128))])])])]),m.value||u.value?(r(),l("div",ve,[e("div",ke,[e("div",{class:"fixed inset-0 bg-black opacity-50",onClick:f}),e("div",fe,[e("h3",he,i(u.value?"Edit Grade":"Add New Grade"),1),e("form",{onSubmit:H(z,["prevent"])},[e("div",we,[e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Grade Name ",-1)),g(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.name=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400",placeholder:"e.g., Grade 1, Class 10A"},null,512),[[A,o.value.name]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Segment ",-1)),g(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.segment=s),required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400"},[...t[13]||(t[13]=[e("option",{value:""},"Select segment",-1),e("option",{value:"primary"},"Primary",-1),e("option",{value:"secondary"},"Secondary",-1),e("option",{value:"sr_secondary"},"Senior Secondary",-1)])],512),[[L,o.value.segment]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Subjects ",-1)),e("div",_e,[(r(!0),l(w,null,h(N.value,s=>(r(),l("div",{key:s.id,class:"flex items-center"},[g(e("input",{type:"checkbox",id:"subject-"+s.id,"onUpdate:modelValue":t[4]||(t[4]=c=>o.value.subjects=c),value:s.id,class:"mr-2"},null,8,Se),[[Y,o.value.subjects]]),e("label",{for:"subject-"+s.id,class:"text-sm"},i(s.name)+" ("+i(s.type)+") ",9,je)]))),128))])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"}," Description (optional) ",-1)),g(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>o.value.description=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:placeholder-gray-400",placeholder:"Grade description..."},null,512),[[A,o.value.description]])])]),e("div",Ce,[e("button",{type:"button",onClick:f,class:"btn btn-secondary"}," Cancel "),e("button",{type:"submit",disabled:p.value,class:"btn btn-primary"},i(p.value?"Saving...":u.value?"Update":"Add"),9,Ge)])],32)])])])):n("",!0)])]),_:1}))}};export{De as default};
